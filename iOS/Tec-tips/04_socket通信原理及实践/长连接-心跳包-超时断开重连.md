### client与server建立长连接

- 建立长连接后，客户端和服务端可以主动发送、接收消息，消息有相应的类型及其内容。因为TCP是面向连接的、可靠的，基于字节流的传输控制协议，接受的数据可能会产生粘包现象，因此要进行拆包处理，方法一：约定的一个完整的消息，有消息头和消息尾，根据头尾，从接收到的数据中进行拆分，获取一个个完整的独立的消息。方法二：约定的一个完整的消息包含消息头和消息长度信息，对接收到的数据进行拆分，得出一个个完整的消息，剩下的不完整的数据与之后接收的数据处理拼接即可。

- 客户端还会建立一个心跳机制，来处理长连接的保活，一般心跳间隔不大于60秒，心跳可以一直执行，也可以根据情况进行优化处理，如接收消息后一定时间间隔内为收到消息，则触发心跳机制，发送心跳包，在连接送法一定次数的心跳包后仍无响应，则连接超时，客户端主动断开连接，重新尝试连接，直至连接成功。心跳包通常还附带一些参数功能。

- 消息有相应的消息类型type和消息标识sign，消息标识sign是一个消息的唯一标识，接收到的响应消息的sign与之一一对应，相同。消息类型type用于指定此消息是什么功能，如聊天类型的消息还是登陆类型的消息。
	
	

